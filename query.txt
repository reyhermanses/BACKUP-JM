--SELECT 
--e.DIREKTORAT, ep.UNIT_KERJA, COUNT(*) AS total
--FROM EMPLOYEE e JOIN EMPLOYEE_POSITION ep 
--WHERE EMPLOYEE_POSITION.EMPLOYEE_ID = EMPLOYEE.ID 
--GROUP BY e.DIREKTORAT
--ORDER BY e.DIREKTORAT

--SELECT
--e.DIREKTORAT, COUNT(e.ID) AS total
--FROM EMPLOYEE e LEFT JOIN EMPLOYEE_POSITION ep ON e.ID = ep.EMPLOYEE_ID
--GROUP BY e.DIREKTORAT

SELECT 
MAX(e.DIREKTORAT), ep.UNIT_KERJA, COUNT(e.ID) AS TOTAL
FROM EMPLOYEE e LEFT JOIN EMPLOYEE_POSITION ep ON ep.EMPLOYEE_ID = e.ID 
WHERE e.DIREKTORAT IS NOT NULL
GROUP BY ep.UNIT_KERJA

--SELECT count(*) 
--FROM EMPLOYEE e LEFT JOIN EMPLOYEE_POSITION ep ON ep.EMPLOYEE_ID = e.ID 
--WHERE ep.UNIT_KERJA = 'Pt Jalantol Lingkarluar Jakarta'
--AND e.DIREKTORAT IS NOT NULL